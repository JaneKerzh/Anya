<!DOCTYPE html>
<html lang="ru">
  <head>
    <meta charset="utf-8">
  </head>
  <style>


  :root {
    --background-color: #C8A2C8;
  }
  body, html {
    font-family: Segoe UI,Frutiger,Frutiger Linotype,Dejavu Sans,Helvetica Neue,Arial,sans-serif; 
    color: white;

    display: flex;
    width: 100%;
    height: 100%;
    background: var(--background-color);
    padding: 0;
    margin: 0;
  }
  button {
    font-family: Segoe UI,Frutiger,Frutiger Linotype,Dejavu Sans,Helvetica Neue,Arial,sans-serif; 
    color: darkred;
  }
  
    .c {
      display: flex;
      flex-direction: column;
      flex: 1 1 auto;
      padding: 1em;
    }
    .img-container {
      display: flex;
      align-items: center;
      justify-content: center;
    }
    
    .img-wrapper {
      position: relative;
    }
    .img-wrapper:after {
      content: '';
      position: absolute;
      bottom: 0;top:0;right:0;left:0;
      box-shadow: 0 0 8px 8px var(--background-color) inset;
    }
    img {
        display: block;
        max-width: 100%;
        max-height: calc(100vh - 14em);
        width: auto;
        height: auto;
    }
    .c > * {
      flex: 1 1 auto;
    }
    p {
      text-align: center;
    }
    ul {
      margin: auto;
      list-style-type: none;
      display: flex;
      flex-direction: row;
      width: 50vw;
      padding: 0;
    }
    .question-area {
      flex-grow: 0;
      padding: 2em;
      padding-top: 0;
    }
    .question-area li {
      flex: 1 1 200px;
      margin: 0.5em;
    }
    .question-area button {
      width: 100%;
      height: 2.5em;
      margin: 0.5ex;
      cursor: pointer;
      
    }
    button:hover {
      box-shadow: 0 0 5px lightblue;
    }
    


    body[hidden] {
       display: none;
    }
  </style>
  <script>
    fetch('./questions.json').then(function (response) {
      return response.json();
    }).then(function (json) {
    document.body.hidden = false;
      var questions = json;
      var index = -1;

      var setQuestion = function (i) {

        var animationDuration = 200;
        if (index != -1) {
          document.body.animate([{opacity: 1}, {opacity: 0}, {opacity: 1}], {duration: animationDuration});
        } else {
          animationDuration = 0;
        }
        
        index = i;
        var q = questions[index];
        var nextImageSrc = 'images/' + (q.id + 1) + '.jpg';
        
        var preload = new Image();
        preload.src = nextImageSrc;

        window.setTimeout(function () {
          document.querySelector("#q").textContent = q.question;
          document.querySelector("#picture").src = nextImageSrc;
          document.querySelector("#picture").onerror = function () {
            document.querySelector("#picture").src = 'images/99.jpg';
          };
          document.querySelector("#answer1").textContent = q.answer1;
          document.querySelector("#answer2").textContent = q.answer2;
          document.querySelector("#answer3").textContent = q.answer3;
          
          document.querySelector("#answer1").onclick =
          document.querySelector("#answer2").onclick =
          document.querySelector("#answer3").onclick = function (event) {
            event.preventDefault();
            if (q.correctAnswer.toString() !== event.target.id.slice('#answer'.length)) {
              document.querySelector("#picture").src = 'images/incorrect.jpg';
              document.querySelector("#picture").animate([{
                'boxShadow': '0 0 3px 12px red'
              }, {
                'boxShadow': '0 0 3px 12px transparent'
              }], {
                duration: 1000,
                iterations: 3
              });
              event.target.animate([{
                'boxShadow': '0 0 3px 3px red'
              }, {
                'boxShadow': '0 0 3px 3px transparent'
              }], {
                duration: 1000,
                iterations: 3
              });
              event.target.setAttribute('title', 'Неправильно!');
              setTimeout(function () {
                event.target.setAttribute('title', '');
              }, 2000);
            } else {
              setQuestion(i + 1);
            }
          };
        }, animationDuration / 2);
      };

      setQuestion(0);
      
    });
  </script>
  <body hidden>
    <div class="c">
      <div class="img-container">
        <div class="img-wrapper">
          <img id="picture" src="picture.jpg" />
        </div>
      </div>
      <div class="question-area">
        <p id="q">Вопрос: что это?</p>
        <ul>
          <li><button id="answer1">Ответ 1</button></li>
          <li><button id="answer2">Ответ 2</button></li>
          <li><button id="answer3">Ответ 3</button></li>
        </ul>
      </div>
    </div>
  </body>
</html>

